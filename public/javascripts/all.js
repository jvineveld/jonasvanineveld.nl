/**
   /~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 
   | Combined & uglified javascript file                                        |
   |                                                                            |
   | Includes:                                                                  / 
   | - public/javascripts/modernizr.js
   | - public/javascripts/general.js
   | - public/javascripts/translate.js
   | - public/javascripts/form-handling.js
   | - public/javascripts/minigame.js
   | - public/javascripts/minigame-notices.js
   |~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\ 
   | @author Jonas van Ineveld, Personal website - 2018                         |
   \~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~/
  */ 

!function(r,m,f){function p(e,t){return typeof e===t}function v(e){return e.replace(/([a-z])-([a-z])/g,function(e,t,n){return t+n.toUpperCase()}).replace(/^-/,"")}function h(){return"function"!=typeof m.createElement?m.createElement(arguments[0]):b?m.createElementNS.call(m,"http://www.w3.org/2000/svg",arguments[0]):m.createElement.apply(m,arguments)}function s(e,t){return function(){return e.apply(t,arguments)}}function o(e){return e.replace(/([A-Z])/g,function(e,t){return"-"+t.toLowerCase()}).replace(/^ms-/,"-ms-")}function i(e,t,n,a){var o,i,r,s,l,d="modernizr",c=h("div"),u=((l=m.body)||((l=h(b?"svg":"body")).fake=!0),l);if(parseInt(n,10))for(;n--;)(r=h("div")).id=a?a[n]:d+(n+1),c.appendChild(r);return(o=h("style")).type="text/css",o.id="s"+d,(u.fake?u:c).appendChild(o),u.appendChild(c),o.styleSheet?o.styleSheet.cssText=e:o.appendChild(m.createTextNode(e)),c.id=d,u.fake&&(u.style.background="",u.style.overflow="hidden",s=y.style.overflow,y.style.overflow="hidden",y.appendChild(u)),i=t(c,e),u.fake?(u.parentNode.removeChild(u),y.style.overflow=s,y.offsetHeight):c.parentNode.removeChild(c),!!i}function g(e,t){var n=e.length;if("CSS"in r&&"supports"in r.CSS){for(;n--;)if(r.CSS.supports(o(e[n]),t))return!0;return!1}if("CSSSupportsRule"in r){for(var a=[];n--;)a.push("("+o(e[n])+":"+t+")");return i("@supports ("+(a=a.join(" or "))+") { #modernizr { position: absolute; } }",function(e){return"absolute"==function(e,t,n){var a;if("getComputedStyle"in r){a=getComputedStyle.call(r,e,t);var o=r.console;null!==a?n&&(a=a.getPropertyValue(n)):o&&o[o.error?"error":"log"].call(o,"getComputedStyle returning null, its possible modernizr test results are inaccurate")}else a=!t&&e.currentStyle&&e.currentStyle[n];return a}(e,null,"position")})}return f}function a(e,t,n,a,o){var i=e.charAt(0).toUpperCase()+e.slice(1),r=(e+" "+u.join(i+" ")+i).split(" ");return p(t,"string")||p(t,"undefined")?function(e,t,n,a){function o(){r&&(delete x.style,delete x.modElem)}if(a=!p(a,"undefined")&&a,!p(n,"undefined")){var i=g(e,n);if(!p(i,"undefined"))return i}for(var r,s,l,d,c,u=["modernizr","tspan","samp"];!x.style&&u.length;)r=!0,x.modElem=h(u.shift()),x.style=x.modElem.style;for(l=e.length,s=0;s<l;s++)if(d=e[s],c=x.style[d],!!~(""+d).indexOf("-")&&(d=v(d)),x.style[d]!==f){if(a||p(n,"undefined"))return o(),"pfx"!=t||d;try{x.style[d]=n}catch(e){}if(x.style[d]!=c)return o(),"pfx"!=t||d}return o(),!1}(r,t,a,o):function(e,t,n){var a;for(var o in e)if(e[o]in t)return!1===n?e[o]:p(a=t[e[o]],"function")?s(a,n||t):a;return!1}(r=(e+" "+w.join(i+" ")+i).split(" "),t,n)}function e(e,t,n){return a(e,f,f,t,n)}var l=[],d=[],t={_version:"3.6.0",_config:{classPrefix:"",enableClasses:!0,enableJSClass:!0,usePrefixes:!0},_q:[],on:function(e,t){var n=this;setTimeout(function(){t(n[e])},0)},addTest:function(e,t,n){d.push({name:e,fn:t,options:n})},addAsyncTest:function(e){d.push({name:null,fn:e})}},c=function(){};c.prototype=t,(c=new c).addTest("history",function(){var e=navigator.userAgent;return(-1===e.indexOf("Android 2.")&&-1===e.indexOf("Android 4.0")||-1===e.indexOf("Mobile Safari")||-1!==e.indexOf("Chrome")||-1!==e.indexOf("Windows Phone")||"file:"===location.protocol)&&(r.history&&"pushState"in r.history)});var y=m.documentElement,b="svg"===y.nodeName.toLowerCase();c.addTest("placeholder","placeholder"in h("input")&&"placeholder"in h("textarea"));var n="Moz O ms Webkit",u=t._config.usePrefixes?n.split(" "):[];t._cssomPrefixes=u;var _=function(e){var t,n=prefixes.length,a=r.CSSRule;if(void 0===a)return f;if(!e)return!1;if((t=(e=e.replace(/^@/,"")).replace(/-/g,"_").toUpperCase()+"_RULE")in a)return"@"+e;for(var o=0;o<n;o++){var i=prefixes[o];if(i.toUpperCase()+"_"+t in a)return"@-"+i.toLowerCase()+"-"+e}return!1};t.atRule=_;var w=t._config.usePrefixes?n.toLowerCase().split(" "):[];t._domPrefixes=w;var E={elem:h("modernizr")};c._q.push(function(){delete E.elem});var x={style:E.elem.style};c._q.unshift(function(){delete x.style}),t.testAllProps=a,t.testAllProps=e,c.addTest("cssanimations",e("animationName","a",!0)),c.addTest("flexbox",e("flexBasis","1px",!0)),c.addTest("flexboxlegacy",e("boxDirection","reverse",!0));var A=t.prefixed=function(e,t,n){return 0===e.indexOf("@")?_(e):(-1!=e.indexOf("-")&&(e=v(e)),t?a(e,t,n):a(e,"pfx"))};c.addTest("objectfit",!!A("objectFit"),{aliases:["object-fit"]}),function(){var e,t,n,a,o,i;for(var r in d)if(d.hasOwnProperty(r)){if(e=[],(t=d[r]).name&&(e.push(t.name.toLowerCase()),t.options&&t.options.aliases&&t.options.aliases.length))for(n=0;n<t.options.aliases.length;n++)e.push(t.options.aliases[n].toLowerCase());for(a=p(t.fn,"function")?t.fn():t.fn,o=0;o<e.length;o++)1===(i=e[o].split(".")).length?c[i[0]]=a:(!c[i[0]]||c[i[0]]instanceof Boolean||(c[i[0]]=new Boolean(c[i[0]])),c[i[0]][i[1]]=a),l.push((a?"":"no-")+i.join("-"))}}(),function(e){var t=y.className,n=c._config.classPrefix||"";if(b&&(t=t.baseVal),c._config.enableJSClass){var a=new RegExp("(^|\\s)"+n+"no-js(\\s|$)");t=t.replace(a,"$1"+n+"js$2")}c._config.enableClasses&&(t+=" "+n+e.join(" "+n),b?y.className.baseVal=t:y.className=t)}(l),delete t.addTest,delete t.addAsyncTest;for(var C=0;C<c._q.length;C++)c._q[C]();r.Modernizr=c}(window,document);var out_animation_time=500,$prev_tab=!1;function remove_active_classes(){for(var e=document.querySelectorAll('[id^="tab"]'),t=0;t<e.length;t++)e[t].removeAttribute("data-active")}function show_tab(e,t){var n=t||e,a=document.getElementById("tab-"+n);if(a){document.getElementById("main").setAttribute("data-trans-to",n),$prev_tab&&$prev_tab.setAttribute("data-active","out");for(var o=document.querySelectorAll("aside button"),i=0;i<o.length;i++)o[i].removeAttribute("data-active");n===t&&e.setAttribute("data-active",!0),setTimeout(function(){remove_active_classes(),a.setAttribute("data-active",!0),document.getElementById("main").setAttribute("class",n),document.getElementById("main").setAttribute("data-active-tab",n),$prev_tab=a},out_animation_time)}}function insert_back_buttons(){for(var e=document.querySelectorAll("#main > article"),t=0;t<e.length;t++){var n=e[t];"tab-intro"!==n.id&&(n.innerHTML+='<button class="back-btn" title="[# md-line | go_back | true #]" onclick="show_tab(this, \'intro\')"><span>x</span></button>')}}insert_back_buttons(),setTimeout(function(){show_tab(document.getElementById("tab-intro"),"intro")},400);var animation_lines=["h2"];function create_animation_lines(){animation_lines.forEach(function(e){var t=document.querySelectorAll(e);if(t.length)for(var n=0;n<t.length;n++)$line=t[n],$line.getAttribute("data-charanimate")||($line.innerHTML=$line.innerHTML.replace("&amp;","&").replace(/./g,function(e){return"<span>"+e+"</span>"}),$line.setAttribute("data-charanimate","true"))})}create_animation_lines();var n=["94","151","30","(0)85","+31"].reverse().join(" ");function switch_language(a,e){e.preventDefault(),document.querySelector("#language-switcher [data-active]").removeAttribute("data-active"),e.target.setAttribute("data-active",!0);var o=e.target.href,i=new XMLHttpRequest;i.open("GET",o+"lines",!0),i.onreadystatechange=function(e){if(4===i.readyState&&200===i.status){var t=JSON.parse(i.responseText);if(replace_lines(t.lines),replace_blocks(t.blocks),replace_forms(t.forms),create_animation_lines(),Modernizr.history){var n={lang:a};history.pushState(n,document.getElementsByTagName("title")[0].innerText,o)}else document.location.href=o}else 4===i.readyState&&200!==i.status&&(document.location.href=o);console.log("new translate ready state",i.readyState,i.status)},i.send()}document.getElementById("phone").innerHTML='<a href="tel:'+n.replace("(0)","").replace(/\s/g,"")+'">'+n+"</a>",document.getElementById("email").innerHTML=[".nl","own","your","eit","mak","@","as","on","j"].reverse().join(""),window.onpopstate=function(e){console.log(e)};var num_lines_replaced=0;function replace_line(e,t){for(var n=document.querySelectorAll('.md-line[data-name="'+e+'"]'),a=0;a<n.length;a++){var o=n[a],i=o.innerHTML;o.innerHTML='<span class="old">'+i+'</span><span class="new">'+t+"</span>",o.setAttribute("data-active",!0),setTimeout(function(e){o.setAttribute("data-active","animate")}.bind(null,o),100*num_lines_replaced),num_lines_replaced++}}function replace_block(e,t){for(var n=document.querySelectorAll('.md-block[data-name="'+e+'"]'),a=0;a<n.length;a++){n[a].innerHTML=t}}function replace_lines(e){for(var t=num_lines_replaced=0;t<Object.keys(e).length;t++){var n=Object.keys(e)[t];replace_line(n,e[n])}}function replace_blocks(e){for(var t=0;t<e.length;t++){var n=e[t];replace_block(n.name,n.block)}}function replace_forms(e){for(var t=0;t<e.length;t++){var n=e[t];document.forms[t]&&(document.forms[t].innerHTML=n)}}var errors=[],lastError={};function show_form_error(e){var t=document.getElementById("validation-info"),n=document.createElement("div");n.innerHTML=e,console.log(e),lastError.$el&&(lastError.$el.parentElement.removeChild(lastError.$el),lastError.fade_timeout&&clearTimeout(lastError.fade_timeout),lastError.remove_timeout&&clearTimeout(lastError.remove_timeout)),lastError.$el=n,lastError.fade_timeout=setTimeout(function(){t.setAttribute("data-fadeout",!0),lastError.remove_timeout=setTimeout(function(){t.removeChild(n),lastError={}},1e3)},1e3),t.appendChild(n)}function send_form(e){var t=function(e){for(var t="",n=Object.keys(e),a=0;a<n.length;a++)t+=""===t?"":"&",t+=n[a]+"="+e[n[a]];return t}(e),n=new XMLHttpRequest;n.open("POST","/mail",!0),n.setRequestHeader("Content-type","application/x-www-form-urlencoded"),n.onreadystatechange=function(e){if(4===n.readyState&&200===n.status){e=JSON.parse(n.responseText);var t=document.getElementById("tab-contact");console.log(e.success,e),e.success?t.setAttribute("data-send",!0):t.setAttribute("data-send",!1)}},n.send(t)}function validateFields(e){for(var t=document.forms.contactform.elements,n=[],a={},o=0;o<t.length;o++){var i=t[o],r="valid"===i.parentElement.dataset.valid;""===i.name||r?a[i.name]=[i.value]:n.push(i.dataset.validationMsg)}return console.log(n,t),n.length?show_form_error(n[0]):(e.setAttribute("disabled",!0),show_form_error(document.getElementById("send-form-btn").dataset.sendingMsg),send_form(a)),!1}function validate_email(e){return e.match(/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/)}function validateInput(e,t){var n=e.value,a=e.parentElement.dataset.valid;if(0<n.length&&!a)e.parentElement.setAttribute("data-valid","filled");else if(0===n.length&&!0!==a)return void e.parentElement.removeAttribute("data-valid");switch(t){case"name":return void(4<=n.length&&"valid"!==a?e.parentElement.setAttribute("data-valid","valid"):0<n.length&&n.length<4&&"valid"===a&&e.parentElement.setAttribute("data-valid","filled"));case"contact":var o=document.getElementById("email_phone_type"),i="Email";return!(!isNaN(n[0])||"+"===n[0])||!!n.includes("@")?(e.dataset.validationMsg=e.dataset.emailValidationMsg,validate_email(n)&&"valid"!==a?e.parentElement.setAttribute("data-valid","valid"):validate_email(n)||"valid"!==a||e.parentElement.setAttribute("data-valid","filled")):(i="Telefoon",e.dataset.validationMsg=e.dataset.phoneValidationMsg,10<=n.length&&"valid"!==a?e.parentElement.setAttribute("data-valid","valid"):n.length<10&&"valid"===a&&e.parentElement.setAttribute("data-valid","filled")),void(o.innerHTML=i);case"description":return void(60<n.length&&"valid"!==a&&e.parentElement.setAttribute("data-valid","valid"))}}function scrollToInput(e){document.body.clientWidth<800&&setTimeout(function(){document.getElementById("tab-contact").scrollTop=e.getBoundingClientRect().top},250)}function lazyload_game_assats(){document.getElementById("start-game").innerHTML='<span class="start"><img width=60 height=60 src=/images/gamepad.svg alt="play?"></span><span class="intro"><img width=90 height=90 src=/images/keyboard.svg alt="Use WASD"></span>'}lazyload_game_assats();var minigame=function(){var p,v,t,a,h,n,o,e,i,r,s=document.getElementsByTagName("body")[0],l=document.getElementById("avatar"),d=new Image,c=1,g=200,y=40,u=[],m=90,b=.2,_=4,w=2,E=.97,x=!0,A=1,C=0,f="[esc] om te stoppen | [spatie] voor pauze",T={up:!1,down:!1,left:!1,right:!1},k=this.notices,S=["h1","#tab-intro p",".social a","aside nav button"],M=[];function $(){u.forEach(function(e){var t,n;t=e.$el,n=e.zindex,t.width=a=document.body.clientWidth,t.height=h=document.body.clientHeight,t.style.left="0px",t.style.top="0px",t.style.zIndex=n,t.style.position="absolute"}),e=l.getBoundingClientRect()}function I(e){var t="keydown"===(e=e||window.event).type;switch(e.keyCode){case 38:case 87:T.up=t;break;case 40:case 83:T.down=t;break;case 37:case 65:T.left=t;break;case 39:case 68:T.right=t;break;case 32:t&&q();break;case 27:t&&(x=!1,u.forEach(function(e){e.$el.parentNode.removeChild(e.$el)}),document.removeEventListener("keydown",I),document.removeEventListener("keyup",I),document.removeEventListener("click",q),s.removeAttribute("game-active"),s.removeAttribute("stage"),s.removeChild(r),["collision-object","touched"].forEach(function(e){for(var t=document.querySelectorAll("["+e+"]"),n=0;n<t.length;n++)t[n].removeAttribute(e),t[n].style.transform=null}),s=d=l=n=o=null,delete window.mg.game)}t&&!x&&[38,87].includes(e.keyCode)&&q()}function B(){i.clearRect(0,0,a,h),i.translate(Math.round(p+g/2),Math.round(v+y/2)),i.rotate((m-90)*Math.PI/180),i.drawImage(d,0-g/2,0-y/2,g,y),i.setTransform(1,0,0,1,0,0)}function L(){if(x){var e=(f=[],M.forEach(function(e,t){var n,a,o,i=e.bounds;if("rect"===e.type){if((o={within_box_x_right:(n={x:p,y:v,width:g,height:y}).x<(a=i).x+a.width,within_box_x_left:n.x+n.width>a.x,within_box_y_bottom:n.y<a.y+a.height,within_box_y_top:n.height+n.y>a.y}).within_box_x_right&&o.within_box_x_left&&o.within_box_y_bottom&&o.within_box_y_top){var r=h-i.y-100;k.show_notice("destroyer"),has_collision=!0,f.push({type:e.type}),e.$el.setAttribute("touched",!0),e.$el.style.transform="translate(0, "+r+"px)",M.splice(t,1)}}else if("avatasdar"===e.type){var s=e.bounds.width/2,l=e.bounds.width/2+e.bounds.x,d=e.bounds.height/2+e.bounds.y,c=g/2,u=l-(g/2+p),m=d-(y/2+v);Math.sqrt(u*u+m*m)<s+c&&f.push({type:"solid"})}}),f);for(direction in 1===M.length&&2!==A&&(A=2,k.play_final_notices()),c=t,C*=E,T)if(T[direction])switch(direction){case"left":m-=_;break;case"right":m+=_;break;case"up":e.length?C+=b:C-=b,T.left&&(3,C+=b),T.right&&(3,C+=b),c=m*Math.PI/180;break;case"down":e.length?C-=b:C+=b}c=m*Math.PI/180,v+=C*Math.sin(c)+w,p+=C*Math.cos(c),prev_pos_y=v,t=c,B(),window.requestAnimationFrame(L),a<p?p=0:p<0&&(p=a),h<v?v=0:v<0&&(v=h)}var f}function q(){(x=!x)&&window.requestAnimationFrame(L)}return s.setAttribute("game-active",!0),(r=document.createElement("span")).id="info-line",r.innerHTML=f,s.appendChild(r),start_time=Date.now(),n=document.createElement("canvas"),s.appendChild(n),i=n.getContext("2d"),o=document.createElement("canvas"),s.appendChild(o),astr_ctx=o.getContext("2d"),u.push({$el:n,zindex:60},{$el:o,zindex:62}),$(),d.onload=function(){p=e.x-10,v=e.y-74,B()},d.src="/images/quadcopter.svg",S.forEach(function(e){for(var t=document.querySelectorAll(e),n=0;n<t.length;n++){var a=t[n];a.setAttribute("collision-object",!0),M.push({$el:a,bounds:a.getBoundingClientRect(),type:"rect"})}}),M.push({$el:l,bounds:l.getBoundingClientRect(),type:"avatar"}),document.activeElement.blur(),document.addEventListener("keydown",I),document.addEventListener("keyup",I),document.addEventListener("click",q),this};function ig(){window.mg.game||(window.mg.game=minigame.apply({notices:new notices}))}window.mg={};var hc=0,ht=3;function eg(){hc===ht?(ig(),hc=0):hc++,document.getElementById("avatar").setAttribute("data-enabler",hc)}!function(){for(var i=0,e=["webkit","moz"],t=0;t<e.length&&!window.requestAnimationFrame;++t)window.requestAnimationFrame=window[e[t]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e[t]+"CancelAnimationFrame"]||window[e[t]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(e,t){var n=(new Date).getTime(),a=Math.max(0,16-(n-i)),o=window.setTimeout(function(){e(n+a)},a);return i=n+a,o}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})}();var notices=function(){var t=document.getElementsByTagName("body")[0],o=document.getElementById("mingame-sounds"),n=!1,a=0,i={destroyer:["Sloop het maar..","Laat je nog iets over voor de rest?","Alles moet kapot!","Dat was m'n favoriet!"],final:["Tja, en dat was het alweer..","Heb nou ook weer niet","zoveel vrije tijd.. Haha!"]},r={avatar:document.getElementById("sound_error"),destroyer:document.getElementById("sound_avatar_destroy"),avatar_success:document.getElementById("sound_avatar_destroy"),solid_astroid:document.getElementById("sound_fail"),point:document.getElementById("sound_coin")};function s(e){var t,n=r[e].cloneNode(!0),a=(t=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)})()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t();n.id=a,o.appendChild(n),n.volume=.3,n.play(),setTimeout(function(e){o.removeChild(document.getElementById(e)),console.log("sound removed")}.bind(null,a),500)}function l(e){$exists=document.getElementById("notice"),$exists&&($exists.setAttribute("getting-removed",!0),$exists.parentNode.removeChild($exists)),$notice=document.createElement("div"),$notice.id="notice",$notice.innerHTML=e,t.appendChild($notice)}this.play_final_notices=function(){var e=i.final.length,t=0,n=setInterval(function(){t<e&&(l(i.final[t]),t++),t===e&&clearInterval(n)},1500)},this.show_notice=function(e){var t;(n!==e||1500<Date.now()-a)&&(console.log("show msg",e),l(i[t=e][Math.floor(Math.random()*i[t].length)]),n=e,a=Date.now()),s(e)}};