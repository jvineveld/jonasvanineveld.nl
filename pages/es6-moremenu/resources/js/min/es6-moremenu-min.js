'use strict';var _createClass=function(){function a(b,c){for(var e,d=0;d<c.length;d++)e=c[d],e.enumerable=e.enumerable||!1,e.configurable=!0,'value'in e&&(e.writable=!0),Object.defineProperty(b,e.key,e)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();Object.defineProperty(exports,'__esModule',{value:!0});function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}var _class=function(){function a(b){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(_classCallCheck(this,a),!!b){this.menu_items=[],this.$moreMenu={},this.$classTarget={},this.$moreLink={},this.$menu=document.querySelector(b),this.moreItemWidth=0,this.lastMenuWidth=0,this.settings={};Object.assign(this.settings,{more_link_contents:'<a href="#">More..</a>',sub_tag_type:'ul',extra_offset:1,check_for_resize:!0},c),this.refresh_menu_items(),this.create_more_menu(),this.create_more_menu_link(),this.move_unfitting_items(),this.get_option('check_for_resize')&&(this.init_throttle(),this.check_for_resizing());var e=new CustomEvent('mm_initialized');this.$menu.dispatchEvent(e,this)}}return _createClass(a,[{key:'get_option',value:function get_option(b){return this.settings[b]}},{key:'calc_item_width',value:function calc_item_width(b){var c=b.clientWidth;return c}},{key:'refresh_menu_items',value:function refresh_menu_items(){var b=this.$menu.children,c=[],_iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var e,f,d=b[Symbol.iterator]();!(_iteratorNormalCompletion=(e=d.next()).done);_iteratorNormalCompletion=!0)f=e.value,c.push({$element:f,width:this.calc_item_width(f)})}catch(g){_didIteratorError=!0,_iteratorError=g}finally{try{!_iteratorNormalCompletion&&d.return&&d.return()}finally{if(_didIteratorError)throw _iteratorError}}this.menu_items=c}},{key:'create_more_menu',value:function create_more_menu(){var b=this.$moreMenu;b=document.createElement(this.get_option('sub_tag_type')),b.className='more-menu',this.$moreMenu=b}},{key:'create_more_menu_link',value:function create_more_menu_link(){var b=this.$moreLink,c=this.$menu,d=this.$moreMenu;b=document.createElement('li'),b.className='more-menu-link',b.innerHTML=this.get_option('more_link_contents'),c.appendChild(b),b.appendChild(d),this.moreItemWidth=this.calc_item_width(b),this.$moreLink=b}},{key:'check_more_menu_link_visibility',value:function check_more_menu_link_visibility(){var b=this.$moreLink,c=this.$moreMenu,d=c.children.length;b.style.display=d?'':'none'}},{key:'move_unfitting_items',value:function move_unfitting_items(){var b=this.$menu,c=this.menu_items,d=this.$moreMenu,e=this.moreItemWidth,f=this.lastMenuWidth,g=this.$moreLink,h=this.calc_item_width(b),j=h-e-this.get_option('extra_offset'),k=0;if(f!==h){f=h;var _iteratorNormalCompletion2=!0,_didIteratorError2=!1,_iteratorError2=void 0;try{for(var n,m=c[Symbol.iterator]();!(_iteratorNormalCompletion2=(n=m.next()).done);_iteratorNormalCompletion2=!0){var o=n.value,p=o.$element,q=o.width;k+q>j?d.appendChild(p):b.appendChild(p),k+=q}}catch(r){_didIteratorError2=!0,_iteratorError2=r}finally{try{!_iteratorNormalCompletion2&&m.return&&m.return()}finally{if(_didIteratorError2)throw _iteratorError2}}this.check_more_menu_link_visibility(),b.appendChild(g);var l=new CustomEvent('mm_moved_items');b.dispatchEvent(l,this)}}},{key:'check_for_resizing',value:function check_for_resizing(){var b=this;this.get_option('check_for_resize')&&window.addEventListener('throttled_resize',function(){return b.move_unfitting_items()})}},{key:'init_throttle',value:function init_throttle(){(function b(c,d,e){e=e||window;var f=!1;e.addEventListener(c,function g(){f||(f=!0,requestAnimationFrame(function(){e.dispatchEvent(new CustomEvent(d)),f=!1}))})})('resize','throttled_resize')}}]),a}();exports.default=_class,function(){function a(b,c){c=c||{bubbles:!1,cancelable:!1,detail:void 0};var d=document.createEvent('CustomEvent');return d.initCustomEvent(b,c.bubbles,c.cancelable,c.detail),d}return'function'!=typeof window.CustomEvent&&void(a.prototype=window.Event.prototype,window.CustomEvent=a)}();